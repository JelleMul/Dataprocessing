var series = [
  ["China",1379880000],
  ["India",1330780000],
  ["United States",324933000],
  ["Indonesia",260581000],
  ["Brazil",206951000],
  ["Pakistan",194818000],
  ["Nigeria",186987000],
  ["Bangladesh",161429000],
  ["Russia",146727405],
  ["Japan",126693000],
  ["Mexico",122273000],
  ["Philippines",103318000],
  ["Ethiopia",101853000],
  ["Vietnam",95261000],
  ["Egypt",91944200],
  ["Democratic Republic of the Congo",85110000],
  ["Germany",82175700],
  ["Iran",79686400],
  ["Turkey",78741053],
  ["Thailand",68145000],
  ["France",66821000],
  ["United Kingdom",65110000],
  ["Italy",60665551],
  ["South Africa",55908000],
  ["Tanzania",55155000],
  ["Myanmar",54635000],
  ["South Korea",50801405],
  ["Colombia",48926100],
  ["Kenya",47251000],
  ["Spain",46812000],
  ["Argentina",43850000],
  ["Ukraine",42650186],
  ["Sudan",41176000],
  ["Algeria",40400000],
  ["Poland",38426809],
  ["Uganda",36860700],
  ["Iraq",36787000],
  ["Canada",36362600],
  ["Morocco",34141000],
  ["Saudi Arabia",32248000],
  ["Malaysia",31834500],
  ["Uzbekistan",31575300],
  ["Peru",31488700],
  ["Venezuela",31028700],
  ["Nepal",30986975],
  ["Ghana",28308301],
  ["Afghanistan",27657145],
  ["Yemen",27478000],
  ["Mozambique",26423700],
  ["Angola",25789024],
  ["Australia",24273700],
  ["North Korea",24213510],
  ["Taiwan",23519518],
  ["Cameroon",22709892],
  ["Ivory Coast",22671331],
  ["Madagascar",22434363],
  ["Sri Lanka",21203000],
  ["Niger",20715000],
  ["Romania",19760000],
  ["Burkina Faso",19034397],
  ["Syria",18564000],
  ["Mali",18341000],
  ["Chile",18191900],
  ["Kazakhstan",17753200],
  ["Netherlands",17063500],
  ["Malawi",16832910],
  ["Ecuador",16623600],
  ["Guatemala",16176133],
  ["Zambia",15933883],
  ["Cambodia",15626444],
  ["Senegal",14799859],
  ["Chad",14497000],
  ["Zimbabwe",14240168],
  ["Guinea",12947000],
  ["South Sudan",12131000],
  ["Rwanda",11553188],
  ["Belgium",11334099],
  ["Cuba",11239004],
  ["Tunisia",11154400],
  ["Somalia",11079000],
  ["Haiti",11078033],
  ["Bolivia",10985059],
  ["Greece",10858018],
  ["Benin",10653654],
  ["Czech Republic",10564866],
  ["Portugal",10341330],
  ["Burundi",10114505],
  ["Dominican Republic",10075045],
  ["Sweden",9954420],
  ["United Arab Emirates",9856000],
  ["Hungary",9823000],
  ["Azerbaijan",9775700],
  ["Jordan",9761720],
  ["Belarus",9505200],
  ["Austria",8767919],
  ["Honduras",8721014],
  ["Israel",8610600],
  ["Tajikistan",8551000],
  ["Switzerland",8364100],
  ["Papua New Guinea",8151300],
  ["Hong Kong",7346700],
  ["Bulgaria",7153784],
  ["Togo",7143000],
  ["Serbia",7076372],
  ["Sierra Leone",7075641],
  ["Paraguay",6854536],
  ["El Salvador",6520675],
  ["Laos",6492400],
  ["Libya",6385000],
  ["Nicaragua",6262703],
  ["Kyrgyzstan",6088000],
  ["Lebanon",5988000],
  ["Denmark",5745526],
  ["Singapore",5607300],
  ["Finland",5501043],
  ["Slovakia",5426252],
  ["Eritrea",5352000],
  ["Norway",5236826],
  ["Central African Republic",4998000],
  ["Costa Rica",4890379],
  ["Palestine",4816503],
  ["Ireland",4757976],
  ["Turkmenistan",4751120],
  ["Republic of the Congo",4741000],
  ["New Zealand",4732480],
  ["Oman",4496760],
  ["Croatia",4190669],
  ["Kuwait",4183658],
  ["Liberia",4076530],
  ["Panama",3814672],
  ["Georgia",3720400],
  ["Mauritania",3718678],
  ["Moldova",3553100],
  ["Bosnia and Herzegovina",3531159],
  ["Uruguay",3480222],
  ["Puerto Ricoi",3474182],
  ["Mongolia",3115675],
  ["Armenia",2995100],
  ["Albania",2886026],
  ["Lithuania",2859709],
  ["Jamaica",2723246],
  ["Qatar",2401598],
  ["Namibia",2324388],
  ["Botswana",2230905],
  ["Macedonia",2071278],
  ["Slovenia",2063371],
  ["Latvia",1957200],
  ["Lesotho",1916000],
  ["The Gambia",1882450],
  ["Kosovo",1836978],
  ["Gabon",1802278],
  ["Guinea-Bissau",1547777],
  ["Bahrain",1404900],
  ["Trinidad and Tobago",1349667],
  ["Estonia",1315944],
  ["Mauritius",1263747],
  ["Equatorial Guinea",1222442],
  ["East Timor",1167242],
  ["Swaziland",1132657],
  ["Djibouti",900000],
  ["Fiji",867000],
  ["Cyprus",847000],
  ["Comoros",806153],
  ["Bhutan",780260],
  ["Guyana",746900],
  ["Macaui",652500],
  ["Solomon Islands",642000],
  ["Montenegro",621810],
  ["Western Sahara",584000],
  ["Luxembourg",576200],
  ["Suriname",541638],
  ["Cape Verde",531239],
  ["Transnistria",475665],
  ["Malta",429344],
  ["Brunei",411900],
  ["Bahamas",378040],
  ["Belize",375909],
  ["Maldives",344023],
  ["Iceland",337610],
  ["Northern Cyprus",294396],
  ["Barbados",285000],
  ["Vanuatu",277500],
  ["French Polynesiai",271800],
  ["New Caledoniai",268767],
  ["Abkhazia",240705],
  ["Samoa",194899],
  ["Sio Tomi and Principe",187356],
  ["Saint Lucia",186000],
  ["Guami",184200],
  ["Curacao",158986],
  ["iNagorno-Karabakh Republic",150932],
  ["Kiribati",113400],
  ["Arubai",110108],
  ["Saint Vincent and the Grenadines",109991],
  ["United States Virgin Islands",106000],
  ["Grenada",103328],
  ["Tonga",103252],
  ["Federated States of Micronesia",102800],
  ["Jersey",102700],
  ["Seychelles",93144],
  ["Antigua and Barbuda",86295],
  ["Isle of Mani",84497],
  ["Andorra",78014],
  ["Dominica",71293],
  ["Guernseyi",63001],
  ["Bermudai",61954],
  ["Cayman Islands",60413],
  ["American Samoa",57100],
  ["Northern Mariana Islands",56940],
  ["Greenland",56186],
  ["Marshall Islands",54880],
  ["South Ossetia",53532],
  ["Faroe Islands",49755],
  ["Saint Kitts and Nevis",46204],
  ["Monaco",38400],
  ["Sint Maarten",38247],
  ["Liechtenstein",37623],
  ["Saint-Martin",36457],
  ["Gibraltar",33140],
  ["San Marino",33005],
  ["Turks and Caicos Islands",31458],
  ["British Virgin Islands",28514],
  ["Bonaire",18905],
  ["Cook Islands",18100],
  ["Palau",17950],
  ["Anguilla",13452],
  ["Wallis and Futuna",11750],
  ["Tuvalu",10640],
  ["Nauru",10084],
  ["Saint Barthlemy",9417],
  ["Saint Pierre and Miquelon",6286],
  ["Montserrat",4922],
  ["Saint Helena, Ascension and Tristan da Cunha",4255],
  ["Sint Eustatius",3877],
  ["Falkland Islands",2563],
  ["Norfolk Island",2302],
  ["Christmas Island",2072],
  ["Saba",1811],
  ["Niue",1470],
  ["Tokelau",1411],
  ["Vatican City",842],
  ["Cocos" ,550],
  ["Pitcairn Islands",57]
];

var country_codes = [
  ["af", "AFG", "Afghanistan"],
  ["ax", "ALA", "Åland Islands"],
  ["al", "ALB", "Albania"],
  ["dz", "DZA", "Algeria"],
  ["as", "ASM", "American Samoa"],
  ["ad", "AND", "Andorra"],
  ["ao", "AGO", "Angola"],
  ["ai", "AIA", "Anguilla"],
  ["aq", "ATA", "Antarctica"],
  ["ag", "ATG", "Antigua and Barbuda"],
  ["ar", "ARG", "Argentina"],
  ["am", "ARM", "Armenia"],
  ["aw", "ABW", "Aruba"],
  ["au", "AUS", "Australia"],
  ["at", "AUT", "Austria"],
  ["az", "AZE", "Azerbaijan"],
  ["bs", "BHS", "Bahamas"],
  ["bh", "BHR", "Bahrain"],
  ["bd", "BGD", "Bangladesh"],
  ["bb", "BRB", "Barbados"],
  ["by", "BLR", "Belarus"],
  ["be", "BEL", "Belgium"],
  ["bz", "BLZ", "Belize"],
  ["bj", "BEN", "Benin"],
  ["bm", "BMU", "Bermuda"],
  ["bt", "BTN", "Bhutan"],
  ["bo", "BOL", "Bolivia"],
  ["bq", "BES", "Bonaire, Sint Eustatius and Saba"],
  ["ba", "BIH", "Bosnia and Herzegovina"],
  ["bw", "BWA", "Botswana"],
  ["bv", "BVT", "Bouvet Island"],
  ["br", "BRA", "Brazil"],
  ["io", "IOT", "British Indian Ocean Territory"],
  ["bn", "BRN", "Brunei Darussalam"],
  ["bg", "BGR", "Bulgaria"],
  ["bf", "BFA", "Burkina Faso"],
  ["bi", "BDI", "Burundi"],
  ["kh", "KHM", "Cambodia"],
  ["cm", "CMR", "Cameroon"],
  ["ca", "CAN", "Canada"],
  ["cv", "CPV", "Cape Verde"],
  ["ky", "CYM", "Cayman Islands"],
  ["cf", "CAF", "Central African Republic"],
  ["td", "TCD", "Chad"],
  ["cl", "CHL", "Chile"],
  ["cnx", "CHN", "China"],
  ["cx", "CXR", "Christmas Island"],
  ["cc", "CCK", "Cocos (Keeling) Islands"],
  ["co", "COL", "Colombia"],
  ["km", "COM", "Comoros"],
  ["cg", "COG", "Republic of the Congo"],
  ["cd", "COD", "Democratic Republic of the Congo"],
  ["ck", "COK", "Cook Islands"],
  ["cr", "CRI", "Costa Rica"],
  ["ci", "CIV", "Ivory Coast"],
  ["hr", "HRV", "Croatia"],
  ["cu", "CUB", "Cuba"],
  ["cw", "CUW", "Curaçao"],
  ["cy", "CYP", "Cyprus"],
  ["cz", "CZE", "Czech Republic"],
  ["dk", "DNK", "Denmark"],
  ["dj", "DJI", "Djibouti"],
  ["dm", "DMA", "Dominica"],
  ["do", "DOM", "Dominican Republic"],
  ["ec", "ECU", "Ecuador"],
  ["eg", "EGY", "Egypt"],
  ["sv", "SLV", "El Salvador"],
  ["gq", "GNQ", "Equatorial Guinea"],
  ["er", "ERI", "Eritrea"],
  ["ee", "EST", "Estonia"],
  ["et", "ETH", "Ethiopia"],
  ["fk", "FLK", "Falkland Islands (Malvinas)"],
  ["fo", "FRO", "Faroe Islands"],
  ["fj", "FJI", "Fiji"],
  ["fi", "FIN", "Finland"],
  ["fr", "FRA", "France"],
  ["gf", "GUF", "French Guiana"],
  ["pf", "PYF", "French Polynesia"],
  ["tf", "ATF", "French Southern Territories"],
  ["ga", "GAB", "Gabon"],
  ["gm", "GMB", "Gambia"],
  ["ge", "GEO", "Georgia"],
  ["de", "DEU", "Germany"],
  ["gh", "GHA", "Ghana"],
  ["gi", "GIB", "Gibraltar"],
  ["gr", "GRC", "Greece"],
  ["gl", "GRL", "Greenland"],
  ["gd", "GRD", "Grenada"],
  ["gp", "GLP", "Guadeloupe"],
  ["gu", "GUM", "Guam"],
  ["gt", "GTM", "Guatemala"],
  ["gg", "GGY", "Guernsey"],
  ["gn", "GIN", "Guinea"],
  ["gw", "GNB", "Guinea-Bissau"],
  ["gy", "GUY", "Guyana"],
  ["ht", "HTI", "Haiti"],
  ["hm", "HMD", "Heard Island and McDonald Islands"],
  ["va", "VAT", "Holy See (Vatican City State)"],
  ["hn", "HND", "Honduras"],
  ["hk", "HKG", "Hong Kong"],
  ["hu", "HUN", "Hungary"],
  ["is", "ISL", "Iceland"],
  ["in", "IND", "India"],
  ["id", "IDN", "Indonesia"],
  ["ir", "IRN", "Iran"],
  ["iq", "IRQ", "Iraq"],
  ["ie", "IRL", "Ireland"],
  ["im", "IMN", "Isle of Man"],
  ["il", "ISR", "Israel"],
  ["it", "ITA", "Italy"],
  ["jm", "JAM", "Jamaica"],
  ["jp", "JPN", "Japan"],
  ["je", "JEY", "Jersey"],
  ["jo", "JOR", "Jordan"],
  ["kz", "KAZ", "Kazakhstan"],
  ["ke", "KEN", "Kenya"],
  ["ki", "KIR", "Kiribati"],
  ["kp", "PRK", "North Korea"],
  ["kr", "KOR", "South Korea"],
  ["kw", "KWT", "Kuwait"],
  ["kg", "KGZ", "Kyrgyzstan"],
  ["la", "LAO", "Laos"],
  ["lv", "LVA", "Latvia"],
  ["lb", "LBN", "Lebanon"],
  ["ls", "LSO", "Lesotho"],
  ["lr", "LBR", "Liberia"],
  ["ly", "LBY", "Libya"],
  ["li", "LIE", "Liechtenstein"],
  ["lt", "LTU", "Lithuania"],
  ["lu", "LUX", "Luxembourg"],
  ["mo", "MAC", "Macao"],
  ["mk", "MKD", "Macedonia"],
  ["mg", "MDG", "Madagascar"],
  ["mw", "MWI", "Malawi"],
  ["my", "MYS", "Malaysia"],
  ["mv", "MDV", "Maldives"],
  ["ml", "MLI", "Mali"],
  ["mt", "MLT", "Malta"],
  ["mh", "MHL", "Marshall Islands"],
  ["mq", "MTQ", "Martinique"],
  ["mr", "MRT", "Mauritania"],
  ["mu", "MUS", "Mauritius"],
  ["yt", "MYT", "Mayotte"],
  ["mx", "MEX", "Mexico"],
  ["fm", "FSM", "Micronesia, Federated States of"],
  ["md", "MDA", "Moldova"],
  ["mc", "MCO", "Monaco"],
  ["mn", "MNG", "Mongolia"],
  ["me", "MNE", "Montenegro"],
  ["ms", "MSR", "Montserrat"],
  ["ma", "MAR", "Morocco"],
  ["mz", "MOZ", "Mozambique"],
  ["mm", "MMR", "Myanmar"],
  ["na", "NAM", "Namibia"],
  ["nr", "NRU", "Nauru"],
  ["np", "NPL", "Nepal"],
  ["nl", "NLD", "Netherlands"],
  ["nc", "NCL", "New Caledonia"],
  ["nz", "NZL", "New Zealand"],
  ["ni", "NIC", "Nicaragua"],
  ["ne", "NER", "Niger"],
  ["ng", "NGA", "Nigeria"],
  ["nu", "NIU", "Niue"],
  ["nf", "NFK", "Norfolk Island"],
  ["mp", "MNP", "Northern Mariana Islands"],
  ["no", "NOR", "Norway"],
  ["om", "OMN", "Oman"],
  ["pk", "PAK", "Pakistan"],
  ["pw", "PLW", "Palau"],
  ["ps", "PSE", "Palestine, State of"],
  ["pa", "PAN", "Panama"],
  ["pg", "PNG", "Papua New Guinea"],
  ["py", "PRY", "Paraguay"],
  ["pe", "PER", "Peru"],
  ["ph", "PHL", "Philippines"],
  ["pn", "PCN", "Pitcairn"],
  ["pl", "POL", "Poland"],
  ["pt", "PRT", "Portugal"],
  ["pr", "PRI", "Puerto Rico"],
  ["qa", "QAT", "Qatar"],
  ["re", "REU", "Réunion"],
  ["ro", "ROU", "Romania"],
  ["ru", "RUS", "Russia"],
  ["rw", "RWA", "Rwanda"],
  ["bl", "BLM", "Saint Barthélemy"],
  ["sh", "SHN", "Saint Helena, Ascension and Tristan da Cunha"],
  ["kn", "KNA", "Saint Kitts and Nevis"],
  ["lc", "LCA", "Saint Lucia"],
  ["mf", "MAF", "Saint Martin (French part)"],
  ["pm", "SPM", "Saint Pierre and Miquelon"],
  ["vc", "VCT", "Saint Vincent and the Grenadines"],
  ["ws", "WSM", "Samoa"],
  ["sm", "SMR", "San Marino"],
  ["st", "STP", "Sao Tome and Principe"],
  ["sa", "SAU", "Saudi Arabia"],
  ["sn", "SEN", "Senegal"],
  ["rs", "SRB", "Serbia"],
  ["sc", "SYC", "Seychelles"],
  ["sl", "SLE", "Sierra Leone"],
  ["sg", "SGP", "Singapore"],
  ["sx", "SXM", "Sint Maarten (Dutch part)"],
  ["sk", "SVK", "Slovakia"],
  ["si", "SVN", "Slovenia"],
  ["sb", "SLB", "Solomon Islands"],
  ["so", "SOM", "Somalia"],
  ["za", "ZAF", "South Africa"],
  ["gs", "SGS", "South Georgia and the South Sandwich Islands"],
  ["ss", "SSD", "South Sudan"],
  ["es", "ESP", "Spain"],
  ["lk", "LKA", "Sri Lanka"],
  ["sd", "SDN", "Sudan"],
  ["sr", "SUR", "Suriname"],
  ["sj", "SJM", "Svalbard and Jan Mayen"],
  ["sz", "SWZ", "Swaziland"],
  ["se", "SWE", "Sweden"],
  ["ch", "CHE", "Switzerland"],
  ["sy", "SYR", "Syria"],
  ["tw", "TWN", "Taiwan"],
  ["tj", "TJK", "Tajikistan"],
  ["tz", "TZA", "Tanzania"],
  ["th", "THA", "Thailand"],
  ["tl", "TLS", "Timor-Leste"],
  ["tg", "TGO", "Togo"],
  ["tk", "TKL", "Tokelau"],
  ["to", "TON", "Tonga"],
  ["tt", "TTO", "Trinidad and Tobago"],
  ["tn", "TUN", "Tunisia"],
  ["tr", "TUR", "Turkey"],
  ["tm", "TKM", "Turkmenistan"],
  ["tc", "TCA", "Turks and Caicos Islands"],
  ["tv", "TUV", "Tuvalu"],
  ["ug", "UGA", "Uganda"],
  ["ua", "UKR", "Ukraine"],
  ["ae", "ARE", "United Arab Emirates"],
  ["gb", "GBR", "United Kingdom"],
  ["us", "USA", "United States"],
  ["um", "UMI", "United States Minor Outlying Islands"],
  ["uy", "URY", "Uruguay"],
  ["uz", "UZB", "Uzbekistan"],
  ["vu", "VUT", "Vanuatu"],
  ["ve", "VEN", "Venezuela"],
  ["vn", "VNM", "Vietnam"],
  ["vg", "VGB", "Virgin Islands, British"],
  ["vi", "VIR", "Virgin Islands, U.S."],
  ["wf", "WLF", "Wallis and Futuna"],
  ["eh", "ESH", "Western Sahara"],
  ["ye", "YEM", "Yemen"],
  ["zm", "ZMB", "Zambia"],
  ["zw", "ZWE", "Zimbabwe"]];

// declare function for adding kommas as thousand seperator
function addCommas(n){
    var rx=  /(\d+)(\d{3})/;
    return String(n).replace(/^\d+/, function(w){
        while(rx.test(w)){
            w= w.replace(rx, '$1,$2');
        }
        return w;
    });
}

// change countries names in data for country_codes
for (i = 0; i <series.length; i++){
  for (j = 0; j < country_codes.length; j++){
    if (series[i][0] === country_codes[j][2]){
      series[i][0] = country_codes[j][1]
    };
  };
};

// make empty dataset
var dataset = {};
// save actual values of the data
var onlyValues = series.map(function(obj){ return obj[1]; });
var minValue = Math.min.apply(null, onlyValues),
        maxValue = Math.max.apply(null, onlyValues);

// make a sqrt scale based on max and min value
var paletteScale = d3.scale.sqrt()
        .domain([minValue,maxValue])
        .range(["#ffffcc","#800026"]); // color brewer

// fill dataset in appropriate format
series.forEach(function(item){ //
    // item example value ["USA", 70]
    var iso = item[0],
            value = item[1];
    // add data to dataset with a fillcolor
    dataset[iso] = { numberOfThings: value, fillColor: paletteScale(value) };
});

var map = new Datamap({
        element: document.getElementById('container'),
        projection: 'mercator', // big world map

        fills: {
          // countries don't listed in dataset will be painted with this color
          defaultFill: '#F5F5F5',
          // listed for legend
          "1 billion": paletteScale(1000000000),
          "500 million": paletteScale(500000000),
          "100 million": paletteScale(100000000),
          "50 million": paletteScale(50000000),
          "10 million": paletteScale(10000000),
          "1 million": paletteScale(1000000)
          },
        data: dataset,
        geographyConfig: {
            borderColor: '#F5F5F5',
            highlightBorderWidth: 2,
            // don't change color on mouse hover
            highlightFillColor: function(geo) {
                return geo['fillColor'] || '#F5F5F5';
            },
            // only change border
            highlightBorderColor: '#000000', // black
            // show desired information in tooltip
            popupTemplate: function(geo, data) {
                // show No data if country not present in dataset
                if (!data) { return ['<div class="hoverinfo">',
                    '<strong>No data</strong>',
                    '</div>'].join('');; }
                // tooltip content
                return ['<div class="hoverinfo">',
                    '<strong>', geo.properties.name, '</strong>',
                    // use addCommas for pretty printed data
                    '<br>Population: <strong>', addCommas(data.numberOfThings), '</strong>',
                    '</div>'].join('');
            }
        }
});

// make legend
value = series[0][0]
map.legend({
    // graph title
    legendTitle : "Country population data",
    defaultFillName: "No data:",
  });
